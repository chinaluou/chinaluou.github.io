<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Tornado&#39;s Blog</title>
  <subtitle>welcome to my Space!</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://chinaluou.github.io/"/>
  <updated>2018-04-11T14:03:49.286Z</updated>
  <id>http://chinaluou.github.io/</id>
  
  <author>
    <name>Tornado</name>
    <email>chinaluou@163.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CODESYS功能块建库移植到底层平台</title>
    <link href="http://chinaluou.github.io/2018/04/10/CODSYS%E5%8A%9F%E8%83%BD%E5%9D%97%E5%BB%BA%E5%BA%93%E7%A7%BB%E6%A4%8D%E5%88%B0%E5%BA%95%E5%B1%82%E5%B9%B3%E5%8F%B0/"/>
    <id>http://chinaluou.github.io/2018/04/10/CODSYS功能块建库移植到底层平台/</id>
    <published>2018-04-10T14:12:37.000Z</published>
    <updated>2018-04-11T14:03:49.286Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-CODESYS平台Lib库的建立"><a href="#1-CODESYS平台Lib库的建立" class="headerlink" title="1. CODESYS平台Lib库的建立"></a>1. CODESYS平台Lib库的建立</h1><hr>
<p>本文以CODESYS V3.5 SP6平台建立一个温度控制PID算法建库，在CODESYS中建立函数接口，具体算法在底层实现。</p>
<ol>
<li><p>打开CODESYS软件，点击”新建工程”，选择”函数库”中的”空白库”，设定文件目录和文件名，如文件夹为：”Temperature”文件名为：”CmpTemperature”，然后确认。<br><img src="http://omsnt3z0g.bkt.clouddn.com/New%20Project.png" alt="New Project"></p>
</li>
<li><p>在POU中选中”CmpTemperature”，右键”添加对象”，单击”程序组织单元…”。<br><img src="http://omsnt3z0g.bkt.clouddn.com/Add%20FB.png" alt="Add FB"></p>
</li>
<li><p>在创建新的POU窗口中，输入名称”MC_TemperatureRegulator”,类型为”功能块”，实现语言为”功能块图(FBD)”，然后点击打开。<br><img src="http://omsnt3z0g.bkt.clouddn.com/Add%20FB1.png" alt="Add FB1"></p>
</li>
<li><p>在POU中选中”MC_TemperatureRegulator”，右键”添加对象”，单击”方法…”。<br><img src="http://omsnt3z0g.bkt.clouddn.com/Add%20FB2.png" alt="Add FB2"></p>
</li>
<li><p>在创建新的方法窗口中，输入名称”FB_Init”，实现语言为”功能块图(FBD)”，然后点击打开。<br><img src="http://omsnt3z0g.bkt.clouddn.com/Add%20FB3.png" alt="Add FB3"></p>
</li>
<li><p>在POU中右键”MC_TemperatureRegulator”，单击”属性…”，单击”编译”选项卡，勾选”外部实现(E)(稍后在系统运行时连接)”，点击确认。同样对”FB_Init”，也进行同样的操作。（因为我们只是在CODESYS中定义接口函数，具体执行放到底层硬件中去实现）<br><img src="http://omsnt3z0g.bkt.clouddn.com/Add%20FB4.png" alt="Add FB4"></p>
</li>
<li><p>在POU中双击”MC_TemperatureRegulator”，然后在右侧变量窗口中填写功能块的接口数参数，其中Axis、TemperatureExpect、TemperatureActual、DutyRatio为自定义参数，其他参数为默认参数。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="string">FUNCTION_BLOCK</span> <span class="string">MC_TemperatureRegulator</span></div><div class="line"></div><div class="line"><span class="string">(*</span> <span class="string">Function</span> <span class="string">block</span> <span class="string">for</span> <span class="string">temperature</span> <span class="string">control</span> <span class="string">*)</span></div><div class="line"><span class="string">(*</span> <span class="string">Function</span> <span class="string">block</span> <span class="string">for</span> <span class="string">PWM</span> <span class="string">duty</span> <span class="string">ratio</span> <span class="string">from</span> <span class="string">expect</span> <span class="string">temperature</span> <span class="string">and</span> <span class="string">actual</span> <span class="string">temperature</span> <span class="string">to</span> <span class="string">Fuzzy</span> <span class="string">*)</span></div><div class="line"></div><div class="line"><span class="string">VAR_IN_OUT</span></div><div class="line"><span class="attr">  Axis:</span> <span class="string">hAxis_REF;</span>				<span class="string">(*</span> <span class="string">Reference</span> <span class="string">to</span> <span class="string">the</span> <span class="string">Axis</span> <span class="string">*)</span></div><div class="line"><span class="string">END_VAR</span></div><div class="line"><span class="string">VAR_INPUT</span></div><div class="line"><span class="attr">  Execute:</span> <span class="string">BOOL</span> <span class="string">:=</span> <span class="number">0</span><span class="string">;</span>     		<span class="string">(*</span> <span class="string">Start</span> <span class="string">the</span> <span class="string">motion</span> <span class="string">at</span> <span class="string">rising</span> <span class="string">edge</span> <span class="string">*)</span></div><div class="line"><span class="attr">  TemperatureExpect:</span> <span class="string">REAL</span> <span class="string">:=</span> <span class="number">0.0</span><span class="string">;</span> 	<span class="string">(*</span> <span class="string">Expect</span> <span class="string">temperature.</span> <span class="string">In</span> <span class="string">technical</span> <span class="string">unit</span> <span class="string">[degree</span> <span class="string">C]</span> <span class="string">*)</span></div><div class="line"><span class="attr">  TemperatureActual:</span> <span class="string">REAL</span> <span class="string">:=</span> <span class="number">0.0</span><span class="string">;</span>	<span class="string">(*</span> <span class="string">Actual</span> <span class="string">temperature.</span> <span class="string">In</span> <span class="string">technical</span> <span class="string">unit</span> <span class="string">[degree</span> <span class="string">C]</span> <span class="string">*)</span>  </div><div class="line"><span class="string">END_VAR</span></div><div class="line"><span class="string">VAR_OUTPUT</span></div><div class="line"><span class="attr">  DutyRatio:</span> <span class="string">REAL</span> <span class="string">:=</span> <span class="number">0</span><span class="string">;</span>			<span class="string">(*</span> <span class="string">PWM</span> <span class="string">duty</span> <span class="string">ratio</span> <span class="string">(0.0</span> <span class="string">~</span> <span class="number">100.0</span><span class="string">)</span> <span class="string">*)</span></div><div class="line"><span class="attr">  Done:</span> <span class="string">BOOL</span> <span class="string">:=</span> <span class="number">0</span><span class="string">;</span>       		<span class="string">(*</span> <span class="string">Commanded</span> <span class="string">is</span> <span class="string">done</span> <span class="string">*)</span></div><div class="line"><span class="attr">  Busy:</span> <span class="string">BOOL</span> <span class="string">:=</span> <span class="number">0</span><span class="string">;</span>       		<span class="string">(*</span> <span class="string">The</span> <span class="string">FB</span> <span class="string">is</span> <span class="string">not</span> <span class="string">finished</span> <span class="string">*)</span></div><div class="line"><span class="attr">  Error:</span> <span class="string">BOOL</span> <span class="string">:=</span> <span class="number">0</span><span class="string">;</span>      		<span class="string">(*</span> <span class="string">Signals</span> <span class="string">that</span> <span class="string">an</span> <span class="string">error</span> <span class="string">has</span> <span class="string">occurred</span> <span class="string">within</span> <span class="string">the</span> <span class="string">function</span> <span class="string">block</span> <span class="string">*)</span></div><div class="line"><span class="attr">  ErrorID:</span> <span class="string">WORD</span> <span class="string">:=</span> <span class="number">1</span><span class="string">;</span>       	<span class="string">(*</span> <span class="string">Error</span> <span class="string">identification</span> <span class="string">*)</span></div><div class="line"><span class="string">END_VAR</span></div><div class="line"><span class="string">VAR</span></div><div class="line"><span class="string">END_VAR</span></div></pre></td></tr></table></figure>
</li>
<li><p>在POU中双击”FB_Init”，然后在右侧变量窗口中填写功能块的接口数参数，其中参数为默认参数。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">METHOD</span> <span class="string">FB_Init</span> <span class="string">:</span> <span class="string">BOOL</span></div><div class="line"><span class="string">VAR_INPUT</span></div><div class="line">	<span class="attr">bInitRetains:</span> <span class="string">BOOL;</span></div><div class="line">	<span class="attr">bInCopyCode:</span> <span class="string">BOOL;</span></div><div class="line"><span class="string">END_VAR</span></div></pre></td></tr></table></figure>
</li>
<li><p>由于在”MC_TemperatureRegulator”的参数申明中，使用私有数据类型”hAxis_REF”，因此编译会报错提示”C0077:  未知的类型: ‘hAxis_REF’”，这个数据类型申明在数据类型库中进行了定义，因此需要添加这个库。在POU中右击”CmpTemperature”，选择”添加对象”，单击”库管理器…”，点击”打开”。然后在右侧单击”添加库”，在”杂项”中，选中”PLCOpen Motion Basic”，点击确认，就完成了库的添加，也可以看库中定义的数据类型。（当然在POU中添加”PLCOpen Motion Basic”这个库，前提是已经在”工具”栏中，”安装库…”中完成了这个库导入CODESYS）<br><img src="http://omsnt3z0g.bkt.clouddn.com/Add%20FB5.png" alt="Add FB5"></p>
</li>
<li><p>选择菜单栏中的”编译”，单击”检测所有池对象”，对程序进行错误检测，如果没有错误后，选择选择菜单栏中的”编译”，单击”生产运行时系统文件”，勾选”C根文件”后点击”确认”。<br><img src="http://omsnt3z0g.bkt.clouddn.com/Add%20FB6.png" alt="Add FB6"></p>
</li>
<li><p>此时，会在文件目录下生成”CmpTemperature.library”、”CmpTemperature.c”、”CmpTemperatureItf.m4”等文件，至此就完成了CODESYS平台下的Lib库的建立。</p>
</li>
</ol>
<h1 id="2-生成底层平台所需要的文件"><a href="#2-生成底层平台所需要的文件" class="headerlink" title="2. 生成底层平台所需要的文件"></a>2. 生成底层平台所需要的文件</h1><hr>
<ol>
<li><p>在其他目录下新建一个文件夹”Temperature”，拷贝CODESYS生成”CmpTemperature.library”、”CmpTemperature.c”、”CmpTemperatureItf.m4”文件，到新建的文件夹。</p>
</li>
<li><p>在新建文件夹中新建文件”CmpTemperatureItf.m4”，具体内容如下所示：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="string">/**</span></div><div class="line"> <span class="string">*</span>  <span class="string">&lt;name&gt;Component</span> <span class="string">Template&lt;/name&gt;</span></div><div class="line"> <span class="string">*</span>  <span class="string">&lt;description&gt;</span> </div><div class="line"> <span class="string">*</span>  <span class="string">An</span> <span class="string">example</span> <span class="string">on</span> <span class="string">how</span> <span class="string">to</span> <span class="string">implement</span> <span class="string">a</span> <span class="string">component.</span></div><div class="line"> <span class="string">*</span>  <span class="string">This</span> <span class="string">component</span> <span class="string">does</span> <span class="literal">no</span> <span class="string">usefull</span> <span class="string">work</span> <span class="string">and</span> <span class="string">it</span> <span class="string">exports</span> <span class="literal">no</span> <span class="string">functions</span></div><div class="line"> <span class="string">*</span>  <span class="string">which</span> <span class="string">are</span> <span class="string">intended</span> <span class="string">to</span> <span class="string">be</span> <span class="string">used</span> <span class="string">for</span> <span class="string">anything.</span> <span class="string">Use</span> <span class="string">at</span> <span class="string">your</span> <span class="string">own</span> <span class="string">risk.</span></div><div class="line"> <span class="string">*</span>  <span class="string">&lt;/description&gt;</span></div><div class="line"> <span class="string">*</span>  <span class="string">&lt;copyright&gt;</span></div><div class="line"> <span class="string">*</span>  <span class="string">(c)</span> <span class="number">2003</span><span class="bullet">-2016</span> <span class="number">3</span><span class="string">S-Smart</span> <span class="string">Software</span> <span class="string">Solutions</span></div><div class="line"> <span class="string">*</span>  <span class="string">&lt;/copyright&gt;</span></div><div class="line"> <span class="string">*/</span></div><div class="line"><span class="string">SET_COMPONENT_NAME(`CmpTemperature')</span></div><div class="line"><span class="string">COMPONENT_SOURCES(`CmpTemperature.c')</span></div><div class="line"></div><div class="line"><span class="string">COMPONENT_VERSION(`0x03050600')</span></div><div class="line"></div><div class="line"><span class="string">/*</span> <span class="attr">NOTE:</span> <span class="string">REPLACE</span> <span class="number">0x0001</span> <span class="string">BY</span> <span class="string">YOUR</span> <span class="string">VENDORID</span> <span class="string">*/</span></div><div class="line"><span class="string">COMPONENT_VENDORID(`0x0001')</span>				</div><div class="line"></div><div class="line"><span class="comment">#define CMPID_CmpTemperature		0x2000								/* <span class="doctag">NOTE:</span> START HERE WITH YOUR COMPONENTIDS (see CmpItf.h */</span></div><div class="line"><span class="comment">#define CLASSID_CCmpTemperature	ADDVENDORID(CMP_VENDORID, 0x2000)	/* <span class="doctag">NOTE:</span> START HERE WITH YOUR CLASSIDS (see CmpItf.h */</span></div><div class="line"><span class="comment">#define ITFID_ICmpTemperature		ADDVENDORID(CMP_VENDORID, 0x2000)	/* <span class="doctag">NOTE:</span> START HERE WITH YOUR INTERFACEIDS (see CmpItf.h */</span></div><div class="line"></div><div class="line"><span class="string">CATEGORY(`Hilectro')</span></div><div class="line"></div><div class="line"><span class="string">IMPLEMENT_ITF(`CmpTemperatureItf.m4')</span></div></pre></td></tr></table></figure>
</li>
<li><p>在新建文件夹中新建批处理文件”CmpTemperatureDep_m4.bat”，具体内容如下所示：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">echo.</span>        <span class="string">*</span> <span class="string">CmpTemperatureDep.m4</span> <span class="string">...</span> <span class="string">CmpTemperatureDep.h</span> </div><div class="line"></div><div class="line"><span class="string">start</span> <span class="string">/B</span> <span class="string">/WAIT</span> <span class="string">..\..\BuildUtils\msys\bin\generate_dep_withCpp.bat</span> <span class="string">CmpTemperatureDep</span> <span class="string">..\..\BuildUtils\msys\bin</span> <span class="string">../../BuildUtils/M4Defs</span> <span class="string">../../Components</span></div></pre></td></tr></table></figure>
</li>
<li><p>在新建文件夹中新建批处理文件”CmpTemperatureItf_m4.bat”，具体内容如下所示：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="string">echo.</span>        <span class="string">*</span> <span class="string">CmpTemperatureItf.m4</span> <span class="string">...</span> <span class="string">CmpTemperatureItf.h</span> </div><div class="line"></div><div class="line"><span class="string">start</span> <span class="string">/B</span> <span class="string">/WAIT</span> <span class="string">..\..\BuildUtils\msys\bin\generate_itf.bat</span> <span class="string">CmpTemperatureItf</span> <span class="string">..\..\BuildUtils\msys\bin</span> <span class="string">../../BuildUtils/M4Defs</span></div></pre></td></tr></table></figure>
</li>
<li><p>依次双击批处理文件”CmpTemperatureDep_m4.bat”、”CmpTemperatureItf_m4.bat”，会在目录下生成文件”CmpTemperature.cpp”、”CmpTemperatureDep.h”、”CmpTemperatureItf.h”三个文件。</p>
</li>
<li><p>至此底层平台所需的文件已经产生。</p>
</li>
</ol>
<h1 id="3-移植代码至底层平台"><a href="#3-移植代码至底层平台" class="headerlink" title="3. 移植代码至底层平台"></a>3. 移植代码至底层平台</h1><hr>
<p>本移植例程以笔者目前的A8工程平台下进行举例说明，笔者底层工程平台将底层和CODESYS连接所需的依赖关系和函数实现分开放置。底层和CODESYS连接所需的依赖关系文件放置在”CODESYS”目录下，函数实现放在”CMP”目录下。<br><img src="http://omsnt3z0g.bkt.clouddn.com/Project%20tree.png" alt="Project tree"></p>
<ol>
<li>在”CODESYS”的”H7”目录下新建文件夹”CmpTemperature”，在新建目录下新建”CmpTemperature.c”，具体内容如下（其中头文件根据实际目录进行添加和修改）：<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div></pre></td><td class="code"><pre><div class="line"><span class="string">/**</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;name&gt;CmpTemplate.c&lt;/name&gt;</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;description&gt;</span> </div><div class="line"> <span class="string">*</span>  <span class="string">Example</span> <span class="string">for</span> <span class="string">an</span> <span class="string">empty</span> <span class="string">runtime</span> <span class="string">component</span> <span class="string">frame</span> <span class="string">that</span> <span class="string">can</span> <span class="string">be</span> <span class="string">used</span> <span class="string">as</span> <span class="string">a</span> <span class="string">starting</span> <span class="string">point</span> <span class="string">to</span> <span class="string">develop</span> <span class="string">own</span> <span class="string">components.</span></div><div class="line"> <span class="string">*</span></div><div class="line"> <span class="string">*</span>  <span class="string">MANDATORY</span> <span class="attr">FUNCTIONS:</span></div><div class="line"> <span class="string">*</span>  <span class="bullet">-</span> <span class="string">ComponentEntry()</span></div><div class="line"> <span class="string">*</span>  <span class="bullet">-</span> <span class="string">ExportFunctions()</span></div><div class="line"> <span class="string">*</span>  <span class="bullet">-</span> <span class="string">ImportFunctions()</span></div><div class="line"> <span class="string">*</span>  <span class="bullet">-</span> <span class="string">CmpGetVersion()</span></div><div class="line"> <span class="string">*</span>  <span class="bullet">-</span> <span class="string">HookFunction()</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;/description&gt;</span></div><div class="line"> <span class="string">*</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;copyright&gt;(c)</span> <span class="number">2003</span><span class="bullet">-2016</span> <span class="number">3</span><span class="string">S-Smart</span> <span class="string">Software</span> <span class="string">Solutions&lt;/copyright&gt;</span></div><div class="line"> <span class="string">*/</span></div><div class="line"></div><div class="line"><span class="comment">#include "CmpStd.h"</span></div><div class="line"><span class="comment">#include "CmpTemperatureDep.h"</span></div><div class="line"></div><div class="line"><span class="comment">#include "../../../Application/CMP/include/mcReference.h"</span></div><div class="line"></div><div class="line"><span class="comment">#include "../../../Application/CMP/Temperature/header/mcTemperatureRegulatorFB.h"</span></div><div class="line"></div><div class="line"><span class="string">USE_STMT</span></div><div class="line"></div><div class="line"><span class="comment">#ifndef RTS_COMPACT_MICRO</span></div><div class="line"></div><div class="line"><span class="string">/**</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;description&gt;Entry</span> <span class="string">function</span> <span class="string">of</span> <span class="string">the</span> <span class="string">component.</span> <span class="string">Called</span> <span class="string">at</span> <span class="string">startup</span> <span class="string">for</span> <span class="string">each</span> <span class="string">component.</span> <span class="string">Used</span> <span class="string">to</span> <span class="string">exchange</span> <span class="string">function</span> <span class="string">pointers</span> <span class="string">with</span> <span class="string">the</span> <span class="string">component</span> <span class="string">manager.&lt;/description&gt;</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;param</span> <span class="string">name="pInitStruct"</span> <span class="string">type="IN"&gt;Pointer</span> <span class="string">to</span> <span class="string">structure</span> <span class="attr">with:</span></div><div class="line"> <span class="string">*</span>		<span class="string">pfExportFunctions</span>	<span class="string">OUT</span> <span class="string">Pointer</span> <span class="string">to</span> <span class="string">function</span> <span class="string">that</span> <span class="string">exports</span> <span class="string">component</span> <span class="string">functions</span></div><div class="line"> <span class="string">*</span>		<span class="string">pfImportFunctions</span>	<span class="string">OUT</span> <span class="string">Pointer</span> <span class="string">to</span> <span class="string">function</span> <span class="string">that</span> <span class="string">imports</span> <span class="string">functions</span> <span class="string">from</span> <span class="string">other</span> <span class="string">components</span></div><div class="line"> <span class="string">*</span>		<span class="string">pfGetVersion</span>		<span class="string">OUT</span> <span class="string">Pointer</span> <span class="string">to</span> <span class="string">function</span> <span class="string">to</span> <span class="string">get</span> <span class="string">component</span> <span class="string">version</span></div><div class="line"> <span class="string">*</span>		<span class="string">pfRegisterAPI</span>		<span class="string">IN</span>	<span class="string">Pointer</span> <span class="string">to</span> <span class="string">component</span> <span class="string">mangager</span> <span class="string">function</span> <span class="string">to</span> <span class="string">register</span> <span class="string">a</span> <span class="string">api</span> <span class="string">function</span></div><div class="line"> <span class="string">*</span>		<span class="string">pfGetAPI</span>			<span class="string">IN</span>	<span class="string">Pointer</span> <span class="string">to</span> <span class="string">component</span> <span class="string">mangager</span> <span class="string">function</span> <span class="string">to</span> <span class="string">get</span> <span class="string">a</span> <span class="string">api</span> <span class="string">function</span></div><div class="line"> <span class="string">*</span>		<span class="string">pfCallHook</span>			<span class="string">IN</span>	<span class="string">Pointer</span> <span class="string">to</span> <span class="string">component</span> <span class="string">mangager</span> <span class="string">function</span> <span class="string">to</span> <span class="string">call</span> <span class="string">a</span> <span class="string">hook</span> <span class="string">function</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;/param&gt;</span> </div><div class="line"> <span class="string">*</span> <span class="string">&lt;result&gt;ERR_OK</span> <span class="string">if</span> <span class="string">component</span> <span class="string">could</span> <span class="string">be</span> <span class="string">initialized,</span> <span class="string">else</span> <span class="string">error</span> <span class="string">code.&lt;/result&gt;</span></div><div class="line"> <span class="string">*/</span></div><div class="line"><span class="string">DLL_DECL</span> <span class="string">int</span> <span class="string">CDECL</span> <span class="string">ComponentEntry(INIT_STRUCT</span> <span class="string">*pInitStruct)</span></div><div class="line"><span class="string">&#123;</span></div><div class="line">	<span class="string">pInitStruct-&gt;CmpId</span> <span class="string">=</span> <span class="string">COMPONENT_ID;</span></div><div class="line">	<span class="string">pInitStruct-&gt;pfExportFunctions</span> <span class="string">=</span> <span class="string">ExportFunctions;</span></div><div class="line">	<span class="string">pInitStruct-&gt;pfImportFunctions</span> <span class="string">=</span> <span class="string">ImportFunctions;</span></div><div class="line">	<span class="string">pInitStruct-&gt;pfGetVersion</span> <span class="string">=</span> <span class="string">CmpGetVersion;</span></div><div class="line">	<span class="string">pInitStruct-&gt;pfHookFunction</span> <span class="string">=</span> <span class="string">HookFunction;</span></div><div class="line">	<span class="string">pInitStruct-&gt;pfCreateInstance</span> <span class="string">=</span> <span class="literal">NULL</span><span class="string">;</span></div><div class="line">	<span class="string">pInitStruct-&gt;pfDeleteInstance</span> <span class="string">=</span> <span class="literal">NULL</span><span class="string">;</span></div><div class="line"></div><div class="line">	<span class="string">s_pfCMRegisterAPI</span> <span class="string">=</span> <span class="string">pInitStruct-&gt;pfCMRegisterAPI;</span></div><div class="line">	<span class="string">s_pfCMRegisterAPI2</span> <span class="string">=</span> <span class="string">pInitStruct-&gt;pfCMRegisterAPI2;</span></div><div class="line">	<span class="string">s_pfCMGetAPI</span> <span class="string">=</span> <span class="string">pInitStruct-&gt;pfCMGetAPI;</span></div><div class="line">	<span class="string">s_pfCMGetAPI2</span> <span class="string">=</span> <span class="string">pInitStruct-&gt;pfCMGetAPI2;</span></div><div class="line">	<span class="string">s_pfCMCallHook</span> <span class="string">=</span> <span class="string">pInitStruct-&gt;pfCMCallHook;</span></div><div class="line">	<span class="string">s_pfCMRegisterClass</span> <span class="string">=</span> <span class="string">pInitStruct-&gt;pfCMRegisterClass;</span></div><div class="line">	<span class="string">s_pfCMCreateInstance</span> <span class="string">=</span> <span class="string">pInitStruct-&gt;pfCMCreateInstance;</span></div><div class="line">	<span class="string">return</span> <span class="string">ERR_OK;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"></div><div class="line"><span class="string">/**</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;description&gt;Publish</span> <span class="string">exported</span> <span class="string">functions</span> <span class="string">to</span> <span class="string">the</span> <span class="string">component</span> <span class="string">manager,</span> <span class="string">to</span> <span class="string">make</span> <span class="string">them</span> <span class="string">available</span> <span class="string">for</span> <span class="string">other</span> <span class="string">components.</span></div><div class="line"> <span class="string">*</span> <span class="string">Use</span> <span class="string">generated</span> <span class="string">macro</span> <span class="string">EXPORT_STMT.&lt;/description&gt;</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;result&gt;ERR_OK</span> <span class="string">or</span> <span class="string">error</span> <span class="string">code</span> <span class="string">in</span> <span class="string">case</span> <span class="string">of</span> <span class="string">error&lt;/result&gt;</span></div><div class="line"> <span class="string">*/</span></div><div class="line"><span class="string">static</span> <span class="string">int</span> <span class="string">CDECL</span> <span class="string">ExportFunctions(void)</span></div><div class="line"><span class="string">&#123;</span></div><div class="line">	<span class="string">/*</span> <span class="string">Macro</span> <span class="string">to</span> <span class="string">export</span> <span class="string">functions</span> <span class="string">*/</span></div><div class="line">	<span class="string">EXPORT_STMT;</span></div><div class="line">	<span class="string">return</span> <span class="string">ERR_OK;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"></div><div class="line"><span class="string">/**</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;description&gt;Import</span> <span class="string">function</span> <span class="string">pointers</span> <span class="string">from</span> <span class="string">other</span> <span class="string">components.</span> <span class="string">Use</span> <span class="string">generated</span> <span class="string">macro</span> <span class="string">IMPORT_STMT.&lt;/description&gt;</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;result&gt;ERR_OK</span> <span class="string">or</span> <span class="string">error</span> <span class="string">code</span> <span class="string">if</span> <span class="string">function</span> <span class="string">name</span> <span class="string">could</span> <span class="string">not</span> <span class="string">be</span> <span class="string">resolved&lt;/result&gt;</span></div><div class="line"> <span class="string">*/</span></div><div class="line"><span class="string">static</span> <span class="string">int</span> <span class="string">CDECL</span> <span class="string">ImportFunctions(void)</span></div><div class="line"><span class="string">&#123;</span></div><div class="line">	<span class="string">/*</span> <span class="string">Macro</span> <span class="string">to</span> <span class="string">import</span> <span class="string">functions</span> <span class="string">*/</span></div><div class="line">	<span class="string">IMPORT_STMT;</span></div><div class="line">	<span class="string">return</span> <span class="string">ERR_OK;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"></div><div class="line"><span class="string">/**</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;description&gt;Return</span> <span class="string">the</span> <span class="string">version</span> <span class="string">of</span> <span class="string">our</span> <span class="string">component.&lt;/description&gt;</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;result&gt;Version</span> <span class="string">as</span> <span class="string">defined</span> <span class="string">in</span> <span class="string">dep</span> <span class="string">file&lt;/result&gt;</span></div><div class="line"> <span class="string">*/</span></div><div class="line"><span class="string">static</span> <span class="string">RTS_UI32</span> <span class="string">CDECL</span> <span class="string">CmpGetVersion(void)</span></div><div class="line"><span class="string">&#123;</span></div><div class="line">	<span class="string">return</span> <span class="string">CMP_VERSION;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"></div><div class="line"><span class="comment">#endif</span></div><div class="line"></div><div class="line"><span class="string">/**</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;description&gt;Hook</span> <span class="string">function</span> <span class="string">to</span> <span class="string">get</span> <span class="string">all</span> <span class="string">broadcast</span> <span class="string">hooks</span> <span class="string">of</span> <span class="string">the</span> <span class="string">component</span> <span class="string">manager.</span> <span class="string">All</span> <span class="string">init</span> <span class="string">and</span> <span class="string">exit</span> <span class="string">stuff</span> <span class="string">must</span> <span class="string">be</span> <span class="string">implemented</span> <span class="string">here!&lt;/description&gt;</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;param</span> <span class="string">name="ulHook"</span> <span class="string">type="IN"&gt;Kind</span> <span class="string">of</span> <span class="string">hook.</span> <span class="string">See</span> <span class="string">CH_</span> <span class="string">definitions</span> <span class="string">in</span> <span class="string">CmpItf.h</span> <span class="string">for</span> <span class="string">details.&lt;/param&gt;</span> </div><div class="line"> <span class="string">*</span> <span class="string">&lt;param</span> <span class="string">name="ulParam1"</span> <span class="string">type="IN"&gt;Hook</span> <span class="string">specific</span> <span class="string">first</span> <span class="string">parameter.</span> <span class="string">See</span> <span class="string">definitions</span> <span class="string">in</span> <span class="string">CmpItf.h</span> <span class="string">for</span> <span class="string">details.&lt;/param&gt;</span> </div><div class="line"> <span class="string">*</span> <span class="string">&lt;param</span> <span class="string">name="ulParam2"</span> <span class="string">type="IN"&gt;Hook</span> <span class="string">specific</span> <span class="string">second</span> <span class="string">parameter.</span> <span class="string">See</span> <span class="string">definitions</span> <span class="string">in</span> <span class="string">CmpItf.h</span> <span class="string">for</span> <span class="string">details.&lt;/param&gt;</span>  </div><div class="line"> <span class="string">*</span> <span class="string">&lt;result&gt;Error</span> <span class="string">code&lt;/result&gt;</span></div><div class="line"> <span class="string">*/</span></div><div class="line"><span class="string">static</span> <span class="string">RTS_RESULT</span> <span class="string">CDECL</span> <span class="string">HookFunction(RTS_UI32</span> <span class="string">ulHook,</span> <span class="string">RTS_UINTPTR</span> <span class="string">ulParam1,</span> <span class="string">RTS_UINTPTR</span> <span class="string">ulParam2)</span></div><div class="line"><span class="string">&#123;</span></div><div class="line">	<span class="string">switch</span> <span class="string">(ulHook)</span></div><div class="line">	<span class="string">&#123;</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_INIT:</span></div><div class="line">			<span class="string">break;</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_INIT2:</span></div><div class="line">			<span class="string">break;</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_INIT3:</span></div><div class="line">			<span class="string">break;</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_INIT_TASKS:</span></div><div class="line">			<span class="string">break;</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_INIT_COMM:</span></div><div class="line">			<span class="string">break;</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_INIT_FINISHED:</span></div><div class="line">			<span class="string">break;</span></div><div class="line"></div><div class="line">		<span class="string">/*</span> <span class="string">Cyclic</span> <span class="string">*/</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_COMM_CYCLE:</span></div><div class="line">			<span class="string">break;</span></div><div class="line"></div><div class="line"><span class="comment">#ifndef RTS_COMPACT_MICRO</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_EXIT_COMM:</span></div><div class="line">			<span class="string">break;</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_EXIT_TASKS:</span></div><div class="line">			<span class="string">break;</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_EXIT3:</span></div><div class="line">			<span class="string">break;</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_EXIT2:</span></div><div class="line">			<span class="string">break;</span></div><div class="line">		<span class="string">case</span> <span class="attr">CH_EXIT:</span></div><div class="line">			<span class="string">break;</span></div><div class="line"><span class="comment">#endif</span></div><div class="line"></div><div class="line">		<span class="attr">default:</span></div><div class="line">			<span class="string">break;</span></div><div class="line">	<span class="string">&#125;</span></div><div class="line">	<span class="string">return</span> <span class="string">ERR_OK;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">```</span> </div><div class="line"></div><div class="line"><span class="number">2.</span> <span class="string">拷贝"CmpTemperatureDep.h"到"CODESYS"目录下的"CmpTemperature"文件夹中。</span></div><div class="line"><span class="string">&#123;%</span> <span class="string">alert</span> <span class="string">warning</span> <span class="literal">no</span><span class="bullet">-icon</span> <span class="string">%&#125;注意修改代码中`#define</span> <span class="string">EXPORT_EXTREF_STMT`段中，将最后一段的的反斜杠去掉。</span></div><div class="line"><span class="string">代码中的0x8A30DA7C、0x3929FC59两个数据是连接CODESYS和底层平台的接口地址，对库进行修改重新编译后这个值会对应的改变，因此在底层平台中也需要对这两个值进行修改！！！</span></div><div class="line"><span class="string">&#123;%</span> <span class="string">endalert</span> <span class="string">%&#125;</span></div><div class="line"><span class="string">```</span> <span class="string">yaml</span></div><div class="line"><span class="comment">#define EXPORT_EXTREF_STMT \</span></div><div class="line">		<span class="string">&#123;</span> <span class="string">(RTS_VOID_FCTPTR)mc_temperatureregulator__main,</span> <span class="string">"mc_temperatureregulator__main"</span><span class="string">,</span> <span class="number">0x8A30DA7C</span><span class="string">,</span> <span class="number">0x00000000</span> <span class="string">&#125;,\</span></div><div class="line">		  <span class="string">&#123;</span> <span class="string">(RTS_VOID_FCTPTR)mc_temperatureregulator__fb_init,</span> <span class="string">"mc_temperatureregulator__fb_init"</span><span class="string">,</span> <span class="number">0x3929FC59</span><span class="string">,</span> <span class="number">0x00000000</span> <span class="string">&#125;,\</span></div><div class="line">		  </div><div class="line"><span class="comment">#else</span></div><div class="line"><span class="comment">#define EXPORT_EXTREF_STMT</span></div><div class="line"><span class="comment">#endif</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>修改为：<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#define EXPORT_EXTREF_STMT \</span></div><div class="line">		<span class="string">&#123;</span> <span class="string">(RTS_VOID_FCTPTR)mc_temperatureregulator__main,</span> <span class="string">"mc_temperatureregulator__main"</span><span class="string">,</span> <span class="number">0x8A30DA7C</span><span class="string">,</span> <span class="number">0x00000000</span> <span class="string">&#125;,\</span></div><div class="line">		  <span class="string">&#123;</span> <span class="string">(RTS_VOID_FCTPTR)mc_temperatureregulator__fb_init,</span> <span class="string">"mc_temperatureregulator__fb_init"</span><span class="string">,</span> <span class="number">0x3929FC59</span><span class="string">,</span> <span class="number">0x00000000</span> <span class="string">&#125;,</span></div><div class="line">		  </div><div class="line"><span class="comment">#else</span></div><div class="line"><span class="comment">#define EXPORT_EXTREF_STMT</span></div><div class="line"><span class="comment">#endif``` </span></div><div class="line"></div><div class="line"></div><div class="line"><span class="number">3.</span> <span class="string">拷贝"CmpTemperatureItf.h"到"CODESYS"目录下的"CmpTemperature"文件夹中，保留一下代码段，其余删除。</span></div><div class="line"><span class="string">```</span> <span class="string">yaml</span></div><div class="line"> <span class="string">/**</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;interfacename&gt;CmpTemperature&lt;/interfacename&gt;</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;description&gt;&lt;/description&gt;</span></div><div class="line"> <span class="string">*</span></div><div class="line"> <span class="string">*</span> <span class="string">&lt;copyright&gt;&lt;/copyright&gt;</span></div><div class="line"> <span class="string">*/</span></div><div class="line"></div><div class="line"></div><div class="line">	</div><div class="line">	</div><div class="line"><span class="comment">#ifndef _CMPTEMPERATUREITF_H_</span></div><div class="line"><span class="comment">#define _CMPTEMPERATUREITF_H_</span></div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="string">/**</span> <span class="string">EXTERN</span> <span class="string">LIB</span> <span class="string">SECTION</span> <span class="string">BEGIN</span> <span class="string">**/</span></div><div class="line"><span class="string">/*</span>  <span class="string">Comments</span> <span class="string">are</span> <span class="string">ignored</span> <span class="string">for</span> <span class="string">m4</span> <span class="string">compiler</span> <span class="string">so</span> <span class="string">restructured</span> <span class="string">text</span> <span class="string">can</span> <span class="string">be</span> <span class="string">used.</span>  <span class="string">*/</span></div><div class="line"></div><div class="line"><span class="comment">#ifdef __cplusplus</span></div><div class="line"><span class="string">extern</span> <span class="string">"C"</span> <span class="string">&#123;</span></div><div class="line"><span class="comment">#endif</span></div><div class="line"></div><div class="line"><span class="string">/**</span> <span class="string">EXTERN</span> <span class="string">LIB</span> <span class="string">SECTION</span> <span class="string">END</span> <span class="string">**/</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="string">typedef</span> <span class="string">struct</span></div><div class="line"><span class="string">&#123;</span></div><div class="line">	<span class="string">IBase_C</span> <span class="string">*pBase;</span></div><div class="line"><span class="string">&#125;</span> <span class="string">ICmpTemperature_C;</span></div><div class="line"></div><div class="line"><span class="comment">#ifdef CPLUSPLUS</span></div><div class="line"><span class="string">class</span> <span class="string">ICmpTemperature</span> <span class="string">:</span> <span class="string">public</span> <span class="string">IBase</span></div><div class="line"><span class="string">&#123;</span></div><div class="line">	<span class="attr">public:</span></div><div class="line"><span class="string">&#125;;</span></div><div class="line">	<span class="comment">#ifndef ITF_CmpTemperature</span></div><div class="line">		<span class="comment">#define ITF_CmpTemperature static ICmpTemperature *pICmpTemperature = NULL;</span></div><div class="line">	<span class="comment">#endif</span></div><div class="line">	<span class="comment">#define EXTITF_CmpTemperature</span></div><div class="line"><span class="comment">#else	/*CPLUSPLUS*/</span></div><div class="line">	<span class="string">typedef</span> <span class="string">ICmpTemperature_C</span>		<span class="string">ICmpTemperature;</span></div><div class="line">	<span class="comment">#ifndef ITF_CmpTemperature</span></div><div class="line">		<span class="comment">#define ITF_CmpTemperature</span></div><div class="line">	<span class="comment">#endif</span></div><div class="line">	<span class="comment">#define EXTITF_CmpTemperature</span></div><div class="line"><span class="comment">#endif</span></div><div class="line"></div><div class="line"><span class="comment">#ifdef CPLUSPLUS_ONLY</span></div><div class="line">  <span class="comment">#undef CPLUSPLUS_ONLY</span></div><div class="line"><span class="comment">#endif</span></div><div class="line"></div><div class="line"><span class="comment">#endif /*_CMPTEMPERATUREITF_H_*/``` </span></div><div class="line"></div><div class="line"><span class="number">4.</span> <span class="string">在"CMP"文件夹中新建文件夹"Temperature"，在文件夹"Temperature"下新建文件夹"header"、"source"，在文件夹"header"下新建头文件"mcTemperatureRegulatorFB.h"，具体内容如下：</span></div><div class="line"><span class="string">```</span> <span class="string">yaml</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>	<span class="string">NAME</span> <span class="string">OF</span> <span class="attr">PROJECT:</span> <span class="string">xxxxxxx</span>					  					 <span class="attr">Version:</span> <span class="number">1.0</span> <span class="string">(development)</span> <span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>	<span class="string">NAME</span> <span class="string">OF</span> <span class="string">SOURCE</span> <span class="attr">FILE:</span> <span class="string">MC_TEMPERATUREREGULATORFB.h</span> 					  							<span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>																		  																			<span class="string">//</span></div><div class="line"><span class="string">//</span>	<span class="string">Data</span> <span class="string">of</span> <span class="attr">creation:</span> <span class="number">2018.04</span><span class="number">.10</span>										  												<span class="string">//</span></div><div class="line"><span class="string">//</span>	<span class="string">Data</span> <span class="string">of</span> <span class="string">last</span> <span class="attr">modification:</span> <span class="number">2016.04</span><span class="number">.10</span>								  										<span class="string">//</span></div><div class="line"><span class="string">//</span>																		  																			<span class="string">//</span></div><div class="line"><span class="string">//</span>	<span class="attr">DESCRIPTION:</span>                                                              <span class="string">//</span></div><div class="line"><span class="string">//</span>                                                                            <span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>	<span class="string">NAME</span> <span class="string">OF</span> <span class="string">PROJECT</span> <span class="attr">FILE:</span> 			  													<span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>	<span class="string">UTILIZING</span> <span class="attr">COMPILER:</span> <span class="string">Texas</span> <span class="string">Instrument</span> <span class="string">Code</span> <span class="string">Composer</span> <span class="string">Studio</span> <span class="string">V6</span>							<span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>							<span class="string">XXX</span> <span class="string">Xxx</span> <span class="bullet">-</span> <span class="string">Xxxxx</span>						  															<span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"></div><div class="line"><span class="comment">#ifndef _MC_TEMPERATUREREGULATORFB_H_</span></div><div class="line"><span class="comment">#define _MC_TEMPERATUREREGULATORFB_H_</span></div><div class="line"></div><div class="line"><span class="comment">#endif /*_MC_TEMPERATUREREGULATORFB_H_*/</span></div><div class="line"><span class="string">```</span> </div><div class="line"></div><div class="line"><span class="number">5.</span> <span class="string">拷贝"CmpTemperatureItf.h"头文件中字段`/**</span> <span class="string">EXTERN</span> <span class="string">LIB</span> <span class="string">SECTION</span> <span class="string">BEGIN</span> <span class="string">**/`和`/**</span> <span class="string">EXTERN</span> <span class="string">LIB</span> <span class="string">SECTION</span> <span class="string">END</span> <span class="string">**/`之间的内容到"mcTemperatureRegulatorFB.h"中。</span></div><div class="line"></div><div class="line"><span class="number">6.</span> <span class="string">在文件夹"source"下新建C文件"mcTemperatureRegulatorFB.c"，具体内容如下（其中头文件根据实际目录进行添加和修改）：</span></div><div class="line"><span class="string">```</span> <span class="string">yaml</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>	<span class="string">NAME</span> <span class="string">OF</span> <span class="attr">PROJECT:</span> <span class="string">xxxxxx</span>					  					 <span class="attr">Version:</span> <span class="number">1.0</span> <span class="string">(development)</span> <span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>	<span class="string">NAME</span> <span class="string">OF</span> <span class="string">SOURCE</span> <span class="attr">FILE:</span> <span class="string">MC_TEMPERATUREREGULATORFB.c</span> 					  							<span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>																		  																			<span class="string">//</span></div><div class="line"><span class="string">//</span>	<span class="string">Data</span> <span class="string">of</span> <span class="attr">creation:</span> <span class="number">2018.04</span><span class="number">.10</span>										  												<span class="string">//</span></div><div class="line"><span class="string">//</span>	<span class="string">Data</span> <span class="string">of</span> <span class="string">last</span> <span class="attr">modification:</span> <span class="number">2016.04</span><span class="number">.10</span>								  										<span class="string">//</span></div><div class="line"><span class="string">//</span>																		  																			<span class="string">//</span></div><div class="line"><span class="string">//</span>	<span class="attr">DESCRIPTION:</span>                                                              <span class="string">//</span></div><div class="line"><span class="string">//</span>                                                                            <span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>	<span class="string">NAME</span> <span class="string">OF</span> <span class="string">PROJECT</span> <span class="attr">FILE:</span> 			  													<span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>	<span class="string">UTILIZING</span> <span class="attr">COMPILER:</span> <span class="string">Texas</span> <span class="string">Instrument</span> <span class="string">Code</span> <span class="string">Composer</span> <span class="string">Studio</span> <span class="string">V6</span>							<span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"><span class="string">//</span>							<span class="string">XXX</span> <span class="string">Xxx</span> <span class="bullet">-</span> <span class="string">Xxxxx</span>						  															<span class="string">//</span></div><div class="line"><span class="string">//----------------------------------------------------------------------------//</span></div><div class="line"></div><div class="line"><span class="string">//</span> <span class="string">type</span> <span class="string">defines</span></div><div class="line"><span class="comment">#include &lt;stdbool.h&gt;</span></div><div class="line"><span class="comment">#include &lt;stdint.h&gt;</span></div><div class="line"></div><div class="line"><span class="string">//</span> <span class="string">application</span> <span class="string">include</span></div><div class="line"><span class="comment">#include "../../../../Library/Type/LIB_Type.h"</span></div><div class="line"></div><div class="line"><span class="comment">#include "../../../common/Defines.h"</span></div><div class="line"></div><div class="line"><span class="comment">#include "../../../API/header/configuration.h"</span></div><div class="line"></div><div class="line"><span class="comment">#include "../../../PLC/header/PLCShare.h"</span></div><div class="line"></div><div class="line"><span class="comment">#include "../../../COM/header/chatUSB.h"</span></div><div class="line"></div><div class="line"><span class="comment">#include "../../../../Third/CODESYS/Includes/CmpStd.h"</span></div><div class="line"></div><div class="line"><span class="comment">#include "../../include/mcReference.h"</span></div><div class="line"><span class="comment">#include "../header/mcTemperatureRegulatorFB.h"</span></div></pre></td></tr></table></figure></p>
<ol>
<li>拷贝”CmpTemperature.c”文件中的函数定义到”mcTemperatureRegulatorFB.c”文件中。<br>``` yaml<br>void CDECL CDECL_EXT mc_temperatureregulator__fb_init(mc_temperatureregulator_fb_init_struct *p)<br>{</li>
</ol>
<p>}</p>
<p>void CDECL CDECL_EXT mc_temperatureregulator__main(mc_temperatureregulator_main_struct *p)<br>{</p>
<p>}<br>``` </p>
<ol>
<li>具体函数的实现功能，由用户在以上函数中进行实现，至此我们已经完成了从CODESYS建立FB到移植底层平台的所有步骤。</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1-CODESYS平台Lib库的建立&quot;&gt;&lt;a href=&quot;#1-CODESYS平台Lib库的建立&quot; class=&quot;headerlink&quot; title=&quot;1. CODESYS平台Lib库的建立&quot;&gt;&lt;/a&gt;1. CODESYS平台Lib库的建立&lt;/h1&gt;&lt;hr&gt;
&lt;p
    
    </summary>
    
      <category term="CODESYS" scheme="http://chinaluou.github.io/categories/CODESYS/"/>
    
    
      <category term="PLC" scheme="http://chinaluou.github.io/tags/PLC/"/>
    
  </entry>
  
  <entry>
    <title>Allegro添加Logo利器</title>
    <link href="http://chinaluou.github.io/2017/03/24/Allegro%E6%B7%BB%E5%8A%A0Logo%E5%88%A9%E5%99%A8/"/>
    <id>http://chinaluou.github.io/2017/03/24/Allegro添加Logo利器/</id>
    <published>2017-03-24T10:01:37.000Z</published>
    <updated>2017-04-10T04:05:04.605Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://omsnt3z0g.bkt.clouddn.com/PCB%20Design%20and%20Analysis1.png" alt="PCB Design and Analysis"></p>
<h2 id="LogoMaker-Skill-Utility"><a href="#LogoMaker-Skill-Utility" class="headerlink" title="LogoMaker Skill Utility"></a>LogoMaker Skill Utility</h2><hr>
<p>LogoMaker Skill Utility是一款不错的小插件，在Allegro中添加的PCB Logo精细度比较高，PCB实物上Logo基本没啥毛刺，边角处理的比较光滑。</p>
<h2 id="插件安装步骤"><a href="#插件安装步骤" class="headerlink" title="插件安装步骤"></a>插件安装步骤</h2><hr>
<p>Allegro下我们利用logoMaker Skill utility来实现PCB Logo的添加。</p>
<ol>
<li>下载最新的<a href="http://potrace.sourceforge.net/download" title="potrace" target="_blank" rel="external">potrace</a></li>
<li>解压potrace文件到Cadence安装目录下</li>
<li>添加系统环境变量例如：POTRACE_PATH=X:\Cadence\potrace</li>
<li>下载最新的<a href="http://www.imagemagick.org/script/binary-releases.php" title="ImageMagick" target="_blank" rel="external">ImageMagick</a></li>
<li>解压ImageMagick文件到Cadence安装目录下</li>
<li>添加系统环境变量例如：MAGICK_HOME=X:\Cadence\ImageMagick-6.5.1-3</li>
<li>下载il文件<a href="https://community.cadence.com/cfs-file/__key/telligent-evolution-components-attachments/00-27-00-00-00-00-73-72/logoMaker_5F00_public.il" title="logoMaker_public.il" target="_blank" rel="external">logoMaker_public.il</a></li>
<li>将logoMaker_public.il文件放到skill目录下，例如：X:\Cadence\SPB_16.6\share\local\pcb\skill</li>
<li>打开X:\Cadence\SPB_16.6\share\local\pcb\skill目录下allegro.ilinit文件(若不存在则自己创建)，添加语句<code>load(&quot;logoMaker_public.il&quot;)</code></li>
<li>设置完成，打开Allegro在Command窗口中输入logomaker，启动Logo添加页面，Enjoy it!<br><img src="http://omsnt3z0g.bkt.clouddn.com/LogoMaker.png" alt="loagmaker"></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://omsnt3z0g.bkt.clouddn.com/PCB%20Design%20and%20Analysis1.png&quot; alt=&quot;PCB Design and Analysis&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;LogoMaker-Skill
    
    </summary>
    
      <category term="硬件设计" scheme="http://chinaluou.github.io/categories/%E7%A1%AC%E4%BB%B6%E8%AE%BE%E8%AE%A1/"/>
    
    
      <category term="Allegro" scheme="http://chinaluou.github.io/tags/Allegro/"/>
    
  </entry>
  
  <entry>
    <title>树莓派之初体验</title>
    <link href="http://chinaluou.github.io/2017/03/21/%E6%A0%91%E8%8E%93%E6%B4%BE%E4%B9%8B%E5%88%9D%E4%BD%93%E9%AA%8C/"/>
    <id>http://chinaluou.github.io/2017/03/21/树莓派之初体验/</id>
    <published>2017-03-21T13:26:10.000Z</published>
    <updated>2017-04-10T04:06:41.244Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://omsnt3z0g.bkt.clouddn.com/Raspberry%20Pi.jpg" alt="Raspberry Pi"></p>
<h1 id="关于树莓派"><a href="#关于树莓派" class="headerlink" title="关于树莓派"></a>关于树莓派</h1><p>树莓派出来已经有好几年了，从1代到现在的3代，可伶我之前都没关注过有这么个好玩的东西。树莓派用的是博通的专用芯片，国内也出了类似树莓派的板子香蕉派和香橙派用的是全志的芯片，板卡价格更低至65元，无法想象功能齐全性能杠杠的“小电脑”居然可以做到如此低成本Amazing~~~。</p>
<p>为了体验学习下最终入了一块二手的Pi2的板子，对于上手学习来说100块买个裸板Pi2玩玩很是实惠，树莓派相对与国产的香橙派和香蕉派性能更稳定些。</p>
<h1 id="系统安装"><a href="#系统安装" class="headerlink" title="系统安装"></a>系统安装</h1><p>树莓派的系统安装还是很简单的，选择自己要安装的操作系统从<a href="https://www.raspberrypi.org/downloads/" title="Raspberry Pi" target="_blank" rel="external">Raspberry官网</a>下载系统镜像。我选择是<a href="https://www.raspberrypi.org/downloads/raspbian/" title="Raspbian" target="_blank" rel="external">Raspbian系统</a>，鉴于我手头上只有4G的TF卡所以选择了不带桌面的Lite版，带桌面的Raspbian系统需要8G的TF卡。</p>
<p>系统镜像文件下载后，先通过SDFormatter软件选择逻辑开关ON格式化TF卡，再用Win32DiskImager软件加载镜像写入到格式化后的TF卡中，至此系统安装的准备工作就完成了。</p>
<h1 id="系统初始化"><a href="#系统初始化" class="headerlink" title="系统初始化"></a>系统初始化</h1><p>烧好镜像的TF插入树莓派板子，系统就正式启动了，查看启动输出信息有三种方式：</p>
<ol>
<li>接HDMI显示器和键盘</li>
<li>通过<code>USB转串口TTL电平</code>连接树莓派串口</li>
<li>树莓派默认开启SSH，扫描树莓派IP地址后通过SSH连接</li>
</ol>
<div class="alert warning no-icon"><p>注意：最新版本系统又默认关闭了SSH，所以下载的是最新系统的话只能选择1、2方式进行初始设置，开启SSH才能通过网络连接。</p>
</div>
<p>树莓派默认登录用户名：pi，密码：raspberry；登录系统需要设置修改以下配置方便日后操作。</p>
<ul>
<li>扩展TF卡全部空间（输入：<code>sudo raspi-config</code>，选择<code>1 Expand Filesystem</code>）</li>
<li>启动root账户（输入：<code>sudo passwd root</code>，再输入2次密码）</li>
<li>修改软件源列表（输入：<code>sudo nano /etc/apt/sources.list</code>，删除文件里设置的软件源替换为以下列表）</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="string">deb</span> <span class="attr">http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/</span> <span class="string">wheezy</span> <span class="string">main</span> <span class="string">non-free</span> <span class="string">contrib</span></div><div class="line"><span class="string">deb-src</span> <span class="attr">http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/</span> <span class="string">wheezy</span> <span class="string">main</span> <span class="string">non-free</span> <span class="string">contrib</span></div><div class="line"><span class="string">deb</span> <span class="attr">http://mirror.sysu.edu.cn/raspbian/raspbian/</span> <span class="string">wheezy</span> <span class="string">main</span> <span class="string">non-free</span> <span class="string">contrib</span></div><div class="line"><span class="string">deb-src</span> <span class="attr">http://mirror.sysu.edu.cn/raspbian/raspbian/</span> <span class="string">wheezy</span> <span class="string">main</span> <span class="string">non-free</span> <span class="string">contrib</span></div><div class="line"></div><div class="line"><span class="string">deb</span> <span class="attr">http://mirrors.cqu.edu.cn/Raspbian/raspbian</span> <span class="string">jessie</span> <span class="string">main</span> <span class="string">contrib</span> <span class="string">non-free</span> <span class="string">rpi</span></div><div class="line"><span class="string">deb-src</span> <span class="attr">http://mirrors.cqu.edu.cn/Raspbian/raspbian/</span> <span class="string">jessie</span> <span class="string">main</span> <span class="string">contrib</span> <span class="string">non-free</span> <span class="string">rpi</span></div><div class="line"><span class="string">deb</span> <span class="attr">http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/</span> <span class="string">jessie</span> <span class="string">main</span> <span class="string">non-free</span> <span class="string">contrib</span></div><div class="line"><span class="string">deb-src</span> <span class="attr">http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/</span> <span class="string">jessie</span> <span class="string">main</span> <span class="string">non-free</span> <span class="string">contrib</span></div><div class="line"><span class="string">deb</span> <span class="attr">http://mirrors.zju.edu.cn/raspbian/raspbian/</span> <span class="string">jessie</span> <span class="string">main</span> <span class="string">contrib</span> <span class="string">non-free</span> <span class="string">rpi</span></div><div class="line"><span class="string">deb-src</span> <span class="attr">http://mirrors.zju.edu.cn/raspbian/raspbian/</span> <span class="string">jessie</span> <span class="string">main</span> <span class="string">contrib</span> <span class="string">non-free</span> <span class="string">rpi</span></div></pre></td></tr></table></figure>
<ul>
<li><p>设置静态IP（输入：<code>sdo nano /etc/dhcpcd.conf</code>，然后在末尾添加以下设置）</p>
<blockquote>
<p>interface eth0<br>static ip_address=192.168.1.110/24<br>static routers=192.168.1.1<br>static domain_name_servers=202.102.152.3 114.114.114.114</p>
</blockquote>
</li>
<li><p>如果想通过SSH登录root账户</p>
<blockquote>
<p>输入：sudo nano /etc/ssh/sshd_config<br>将PermitRootLogin no改成PermitRootLogin yes</p>
</blockquote>
</li>
</ul>
<p>完成以上设置后就可以重启树莓派了。</p>
<h1 id="桌面系统远程VNC设置"><a href="#桌面系统远程VNC设置" class="headerlink" title="桌面系统远程VNC设置"></a>桌面系统远程VNC设置</h1><p>最新版的Raspbian系统已经自带VNCserver只需要在设置里启用一下，然后设置就可以用啦。</p>
<p>输入：<code>sudo raspi-config</code></p>
<p>选择<code>5.Interfacing Options</code></p>
<p>找到VNC（远程桌面），选择Yes（是）enable</p>
<p>输入：<code>sudo nano /etc/init.d/vncserver</code></p>
<p>然后 复制下面的内容 右键粘贴进去</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line"><span class="comment">### BEGIN INIT INFO</span></div><div class="line"><span class="comment"># Provides:          vncserver</span></div><div class="line"><span class="comment"># Required-Start:    $local_fs</span></div><div class="line"><span class="comment"># Required-Stop:     $local_fs</span></div><div class="line"><span class="comment"># Default-Start:     2 3 4 5</span></div><div class="line"><span class="comment"># Default-Stop:      0 1 6</span></div><div class="line"><span class="comment"># Short-Description: Start/stop vncserver</span></div><div class="line"><span class="comment">### END INIT INFO</span></div><div class="line"> </div><div class="line"><span class="comment"># More details see:</span></div><div class="line"><span class="comment"># http://www.penguintutor.com/linux/vnc</span></div><div class="line"> </div><div class="line"><span class="comment">### Customize this entry</span></div><div class="line"><span class="comment"># Set the USER variable to the name of the user to start vncserver under</span></div><div class="line"><span class="built_in">export</span> USER=<span class="string">'pi'</span></div><div class="line"><span class="comment">### End customization required</span></div><div class="line"> </div><div class="line"><span class="built_in">eval</span> <span class="built_in">cd</span> ~<span class="variable">$USER</span></div><div class="line"> </div><div class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></div><div class="line">  start)</div><div class="line">    <span class="comment"># 启动命令行。此处自定义分辨率、控制台号码或其它参数。</span></div><div class="line">    su <span class="variable">$USER</span> -c <span class="string">'/usr/bin/vncserver -depth 16 -geometry 1024x768 :1'</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">"Starting VNC server for <span class="variable">$USER</span> "</span></div><div class="line">    ;;</div><div class="line">  stop)</div><div class="line">    <span class="comment"># 终止命令行。此处控制台号码与启动一致。</span></div><div class="line">    su <span class="variable">$USER</span> -c <span class="string">'/usr/bin/vncserver -kill :1'</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">"vncserver stopped"</span></div><div class="line">    ;;</div><div class="line">  *)</div><div class="line">    <span class="built_in">echo</span> <span class="string">"Usage: /etc/init.d/vncserver &#123;start|stop&#125;"</span></div><div class="line">    <span class="built_in">exit</span> 1</div><div class="line">    ;;</div><div class="line"><span class="keyword">esac</span></div><div class="line"><span class="built_in">exit</span> 0</div></pre></td></tr></table></figure>
<p>然后Ctrl+O回车保存，Ctrl+X退出文本编辑器</p>
<p>修改权限：<code>sudo chmod 755 /etc/init.d/vncserver</code></p>
<p>然后添加开机启动项：<code>sudo update-rc.d vncserver defaults</code></p>
<p>最后重启树莓派:<code>sudo reboot</code></p>
<p>如果不出意外  树莓派开机后 就可以连接VNC了</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://omsnt3z0g.bkt.clouddn.com/Raspberry%20Pi.jpg&quot; alt=&quot;Raspberry Pi&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;关于树莓派&quot;&gt;&lt;a href=&quot;#关于树莓派&quot; class=&quot;headerlink&quot;
    
    </summary>
    
      <category term="Raspberry Pi" scheme="http://chinaluou.github.io/categories/Raspberry-Pi/"/>
    
    
      <category term="树莓派" scheme="http://chinaluou.github.io/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
      <category term="Linux" scheme="http://chinaluou.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>建站小记</title>
    <link href="http://chinaluou.github.io/2017/03/12/%E5%BB%BA%E7%AB%99%E5%B0%8F%E8%AE%B0/"/>
    <id>http://chinaluou.github.io/2017/03/12/建站小记/</id>
    <published>2017-03-12T02:10:10.000Z</published>
    <updated>2017-04-10T04:07:14.864Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://d1u9biwaxjngwg.cloudfront.net/welcome-to-tranquilpeak/city-750.jpg" alt="pic"></p>
<h1 id="缘由"><a href="#缘由" class="headerlink" title="缘由"></a>缘由</h1><p>最近学习相关Python相关东西，很多开源的代码都在Github上，于是乎自己也注册了Github的账户，闲逛Github时发现很多个人博客都是放在Github上，然后就搜索Github相关建站的原理资料，基本上就是GitHub+Hexo搭建免费独立个人博客。</p>
<h1 id="建站目的"><a href="#建站目的" class="headerlink" title="建站目的"></a>建站目的</h1><p>博客已经流行N年了，以前基本都是在第三方平台上开博，博客的分隔和布局排版均受限于第三方。但是GitHub+Hexo方式建立的个人博客就开放多了，可以选各式各样的主题风格布局方式，这点是比较吸引我的地方，建立这个博客的目的最初目的也是为了学习下这个这种方式建站，于是此次博就诞生了！</p>
<h1 id="后续想法"><a href="#后续想法" class="headerlink" title="后续想法"></a>后续想法</h1><p>既然开了博客那也就想后续在这里记录些个人工作、学习、生活等等相关事宜，内容上就待自己慢慢完善了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://d1u9biwaxjngwg.cloudfront.net/welcome-to-tranquilpeak/city-750.jpg&quot; alt=&quot;pic&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;缘由&quot;&gt;&lt;a href=&quot;#缘由&quot; class=&quot;head
    
    </summary>
    
      <category term="Other" scheme="http://chinaluou.github.io/categories/Other/"/>
    
    
      <category term="Github" scheme="http://chinaluou.github.io/tags/Github/"/>
    
  </entry>
  
</feed>
